<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/lib/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="assets/lib/remixicon/remixicon.css">
    <link rel="stylesheet" href="assets/lib/swiper/swiper-bundle.min.css">
    <title>Bolos da Yasmin</title>
    <script src="assets/lib/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="assets/lib/bootstrap/popper.min.js"></script>
    <script src="assets/lib/swiper/swiper-bundle.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCiIfKT6ZeZVo5MJpOBaTZTvO2whCB3yjY",
            authDomain: "bolos-da-yasmin.firebaseapp.com",
            projectId: "bolos-da-yasmin",
            storageBucket: "bolos-da-yasmin.appspot.com",
            messagingSenderId: "741215947057",
            appId: "1:741215947057:web:cda2faf81ec994a8a68810",
            measurementId: "G-Q9QFFWM71H"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let allCakes = [];

        async function loadCakes() {
            const cakeContainer = document.getElementById("cakeContainer");
            const querySnapshot = await getDocs(collection(db, "bolos"));
            allCakes = [];

            querySnapshot.forEach((doc) => {
                const cake = doc.data();
                cake.id = doc.id;
                allCakes.push(cake);
                renderCakeCard(cake); // Mover a renderização para uma função separada
            });
        }

        function renderCakeCard(cake) {
            const cakeContainer = document.getElementById("cakeContainer");
            const cakeCard = `
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <img src="${cake.imagem}" class="card-img-top" alt="${cake.nome}">
                        <div class="card-body">
                            <h5 class="card-title">${cake.nome}</h5>
                            <p class="card-text">Preço: R$${cake.preco}</p>
                            <button class="btn btn-primary" onclick="addToCart('${cake.id}', '${cake.nome}', '${cake.preco}', '${cake.imagem}')">Adicionar ao Carrinho</button>
                        </div>
                    </div>
                </div>
            `;
            cakeContainer.innerHTML += cakeCard;
        }

        window.addToCart = function (id, nome, preco, imagem) {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const item = { id, nome, preco, imagem };
            cart.push(item);
            localStorage.setItem('cart', JSON.stringify(cart));
            alert(`${nome} adicionado ao carrinho!`);
        };

        function searchCakes(event) {
            event.preventDefault();
            const query = document.getElementById("searchInput").value.toLowerCase();
            const cakeContainer = document.getElementById("cakeContainer");
            cakeContainer.innerHTML = "";

            const filteredCakes = allCakes.filter(cake => cake.nome.toLowerCase().includes(query));

            filteredCakes.forEach(cake => {
                renderCakeCard(cake); // Usar a função de renderização
            });

            // Mensagem se não encontrar bolos
            if (filteredCakes.length === 0) {
                cakeContainer.innerHTML = '<div class="col-12"><p class="text-center">Nenhum bolo encontrado.</p></div>';
            }
        }

        window.onload = loadCakes;
    </script>
</head>

<body style="background-color: #deaef296 !important;">
    <nav class="navbar navbar-expand-lg" style="background-color: #f2c4c8c5 !important; ">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Bolos da Yasmin</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html">Cardápio</a>
                    </li>
                    <li class="nav-item">
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="pedidos.html">Carrinho</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="admin.html">Admin</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-3">
        <h1 class="text-center">Cardápio</h1>
        <div class="container mt-5">
            <div class="row" id="cakeContainer">
                <!-- Os cards dos bolos aparecerão aqui -->
            </div>
        </div>
    </div>
    <footer style="background-color: #deaef296; padding: 20px;">
        <div class="container">
            <div class="row align-items-center text-center">
                <div class="col-md-6">
                    <i class="ri-money-dollar-circle-line" style="font-size: 2rem; color: #000;"></i>
                    <p>Aceitamos PIX</p>
                </div>
                <div class="col-md-6">
                    <i class="ri-phone-line" style="font-size: 2rem; color: #000;"></i>
                    <p>(67) 99974-7470</p>
                </div>
            </div>
            <p class="mt-3 text-center">&copy; 2024 Bolos da Yasmin</p>
        </div>
    </footer>
</body>

</html>